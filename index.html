<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>datamanagement: datamanagement</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="DSMLogo.png"/></td>
  <td id="projectalign">
   <div id="projectname">datamanagement<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">Data Management Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">datamanagement </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> <img src="./docs/images/DSMLogo.png" alt="Data Source Management at the Syndemics Lab" width="50%" style="display: block; margin-left: auto; margin-right: auto;" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md1"></a>
DataManagement</h1>
<p><a href="https://www.gnu.org/licenses/agpl-3.0"><img src="https://img.shields.io/badge/License-AGPL_v3-blue.svg" alt="License: AGPL v3" style="pointer-events: none;" class="inline"/></a> <img src="https://img.shields.io/github/v/release/SyndemicsLab/DataManagement" alt="GitHub Release" class="inline"/> <img src="https://img.shields.io/github/actions/workflow/status/SyndemicsLab/DataManagement/unit_testing.yml?label=Tests" alt="Unit Tests" class="inline"/> <img src="https://img.shields.io/github/actions/workflow/status/SyndemicsLab/DataManagement/deploy-docs.yml?label=Docs" alt="Document Generation" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md2"></a>
About DataManagement</h2>
<p>This repository contains the primary interface for managing all data sources for models developed and maintained at the Syndemics Lab at Boston Medical Center. Currently, all sources are either a CSV file, Database File (SQLite), or an <code>ini</code> structured configuration file. For more information please see the examples below.</p>
<h3><a class="anchor" id="autotoc_md3"></a>
License</h3>
<p>Copyright 2024-2025, Syndemics Lab, All rights reserved.</p>
<p>Distributed under the AGPLv3 license.</p>
<p>Any questions, please reach out to <a href="jocelyn.vititow@bmc.org">Jocelyn Vititow</a> or <a href="caroline.savitzky@bmc.org">Caroline Savitzky</a>.</p>
<h4><a class="anchor" id="autotoc_md4"></a>
Note On Redistribution</h4>
<p>While licensed under the AGPLv3 License for fair use, we would appreciate a mention or link to the repository in any publications.</p>
<h3><a class="anchor" id="autotoc_md5"></a>
Supported Platforms</h3>
<p>As we make use of the std::filesystem library, we require a C++20 compiler. To build with CMake we require a CMake Version &gt;= 3.20.</p>
<p>Development was done with:</p>
<ul>
<li>Ubuntu 22.04</li>
<li>Github Actions</li>
</ul>
<p>IDEs and Compilers used:</p>
<ul>
<li>GCC 11.4.0</li>
<li>VSCode</li>
<li>Emacs</li>
</ul>
<h3><a class="anchor" id="autotoc_md6"></a>
Dependencies</h3>
<ul>
<li>C++20 STL Implementation</li>
<li>CMake &gt;= 3.20</li>
<li><a href="https://eigen.tuxfamily.org/">Eigen</a> - For Matrix based operations with data</li>
<li><a href="https://github.com/gabime/spdlog">spdlog</a> - For logging info, warnings, and errors</li>
<li><a href="https://github.com/SRombauts/SQLiteCpp">SQLiteCpp</a> - For easy C++ styled manipulation of SQLite, rather than using the C-styled SQLite native API</li>
<li><a href="https://www.boost.org/doc/libs/1_81_0/doc/html/property_tree.html">Boost Property Tree</a> - For reading the <code>ini</code> styled config files and parsing them into human usable inputs</li>
<li><a href="https://github.com/google/googletest">GoogleTest/GTest</a> (optional) - For building and running unit tests</li>
</ul>
<h2><a class="anchor" id="autotoc_md7"></a>
Getting Started</h2>
<h3><a class="anchor" id="autotoc_md8"></a>
Installation</h3>
<p>To use this tool, we recommend installing the project locally and then incorporating it with the CMake <code>find_package()</code> functionality.</p>
<p>Example Installation for Linux:</p>
<div class="fragment"><div class="line">git clone git@github.com:SyndemicsLab/DataManagement.git</div>
<div class="line">cd DataManagement</div>
<div class="line">mkdir build &amp;&amp; cd $_</div>
<div class="line">cmake .. -DCMAKE_BUILD_TYPE=Release</div>
<div class="line">cmake --build . --target install --config Release</div>
</div><!-- fragment --><p>If installed system wide, a <code>DataManagementConfig.cmake</code> file will be generated and installed. This allows for use with any CMake project avaliable.</p>
<p>Example Use in <code>CMakeLists.txt</code>:</p>
<div class="fragment"><div class="line">find_package(datamanagement REQUIRED)</div>
<div class="line"># Here you create your targets necessary</div>
<div class="line">target_link_libraries(my_target PRIVATE datamanagement::datamanagement)</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md9"></a>
Testing</h3>
<p>To run the tests, simply compile with the CMake <code>BUILD_TESTS</code> flag enabled and ensure you include <code>googletest</code> from the dependency list.</p>
<div class="fragment"><div class="line">git clone git@github.com:SyndemicsLab/DataManagement.git</div>
<div class="line">cd DataManagement</div>
<div class="line">mkdir build &amp;&amp; cd $_</div>
<div class="line">cmake .. -DCMAKE_BUILD_TYPE=Debug -DBUILD_TESTS=ON</div>
<div class="line">cmake --build . </div>
<div class="line">./tests/dataTests</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md10"></a>
Data Types</h2>
<h3><a class="anchor" id="autotoc_md11"></a>
Tabular Data</h3>
<p>Tabular data is handled in a DataTable object. DataTables are made up of rows and columns. DataTable has a constructor intended to handle Comma-Separated-Value (CSV) files. There is future plans to also implement a way to read from an SQL Table into a DataTable object.</p>
<h3><a class="anchor" id="autotoc_md12"></a>
Configuration Data</h3>
<p>Configuration file data is read via the Configuration object. It parses an expected ini file making use of the boost property tree and allows for optional parameters and a way to parse apart strings into vectors.</p>
<h2><a class="anchor" id="autotoc_md13"></a>
Examples</h2>
<h3><a class="anchor" id="autotoc_md14"></a>
Config</h3>
<p>First, an example of the file structure is shown below:</p>
<div class="fragment"><div class="line"><span class="comment">// Example Config File Layout</span></div>
<div class="line">std::ofstream file(<span class="stringliteral">&quot;test.conf&quot;</span>);</div>
<div class="line">file &lt;&lt; <span class="stringliteral">&quot;[simulation]&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">file &lt;&lt; <span class="stringliteral">&quot;duration = 52&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">file &lt;&lt; <span class="stringliteral">&quot;aging_interval = 260&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">file &lt;&lt; <span class="stringliteral">&quot;[state]&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">file &lt;&lt; <span class="stringliteral">&quot;ouds = Active_Noninjection, Active_Injection, &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;Nonactive_Noninjection, Nonactive_Injection&quot;</span></div>
<div class="line">        &lt;&lt; std::endl;</div>
<div class="line">file.close();</div>
</div><!-- fragment --><p>To use the config object, simply create the object and call the get method:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;datamanagement/source/Config.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classdatamanagement_1_1source_1_1Config.html">datamanagement::source::Config</a> config(<span class="stringliteral">&quot;test.conf&quot;</span>);</div>
<div class="line">std::string data = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">config.GetFromConfig(<span class="stringliteral">&quot;simulation.duration&quot;</span>, data);</div>
<div class="line"><span class="comment">// data now contains the value &quot;52&quot;</span></div>
<div class="ttc" id="aclassdatamanagement_1_1source_1_1Config_html"><div class="ttname"><a href="classdatamanagement_1_1source_1_1Config.html">datamanagement::source::Config</a></div><div class="ttdef"><b>Definition</b> config.hpp:26</div></div>
</div><!-- fragment --><p>We also have the ability to get the categories for each section in an <code>ini</code> config file:</p>
<div class="fragment"><div class="line">std::vector&lt;std::string&gt; data = {};</div>
<div class="line">config.GetConfigSectionCategories(<span class="stringliteral">&quot;simulation&quot;</span>, data);</div>
<div class="line"><span class="comment">// data now contains {&quot;duration&quot;, &quot;aging_interval&quot;}</span></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md15"></a>
CSV Sources</h3>
<p>An example CSV is shown:</p>
<div class="fragment"><div class="line">std::ofstream file(<span class="stringliteral">&quot;test.csv&quot;</span>);</div>
<div class="line">file &lt;&lt; <span class="stringliteral">&quot;id,name,age\n&quot;</span>;</div>
<div class="line">file &lt;&lt; <span class="stringliteral">&quot;1,Alice,30\n&quot;</span>;</div>
<div class="line">file &lt;&lt; <span class="stringliteral">&quot;2,Bob,25\n&quot;</span>;</div>
<div class="line">file &lt;&lt; <span class="stringliteral">&quot;3,Charlie,35\n&quot;</span>;</div>
<div class="line">file.close();</div>
</div><!-- fragment --><p>Data is retrieved in an <code>Eigen::MatrixXd</code> format and requires specifying columns and optional where conditions.</p>
<div class="fragment"><div class="line">Eigen::MatrixXd filtered_data = csv_source.GetData({<span class="stringliteral">&quot;id&quot;</span>, <span class="stringliteral">&quot;age&quot;</span>}, {{<span class="stringliteral">&quot;name&quot;</span>, <span class="stringliteral">&quot;Alice&quot;</span>}});</div>
<div class="line"><span class="comment">// the matrix contains the values: {1, 30}</span></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md16"></a>
DB Sources</h3>
<p>Setting up the Database File:</p>
<div class="fragment"><div class="line">SQLite::Database db(<span class="stringliteral">&quot;test.db&quot;</span>,</div>
<div class="line">                            SQLite::OPEN_READWRITE | SQLite::OPEN_CREATE);</div>
<div class="line">db.exec(<span class="stringliteral">&quot;CREATE TABLE IF NOT EXISTS test (id INTEGER PRIMARY KEY, name &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;TEXT, age INTEGER);&quot;</span>);</div>
<div class="line">SQLite::Transaction transaction(db);</div>
<div class="line">db.exec(<span class="stringliteral">&quot;INSERT INTO test (name, age) VALUES (&#39;Alice&#39;, 30);&quot;</span>);</div>
<div class="line">db.exec(<span class="stringliteral">&quot;INSERT INTO test (name, age) VALUES (&#39;Bob&#39;, 25);&quot;</span>);</div>
<div class="line">db.exec(<span class="stringliteral">&quot;INSERT INTO test (name, age) VALUES (&#39;Charlie&#39;, 35);&quot;</span>);</div>
<div class="line">transaction.commit();</div>
</div><!-- fragment --><p>To Select Data from the Database:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;datamanagement/source/DBSource.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classdatamanagement_1_1source_1_1DBSource.html">datamanagement::source::DBSource</a> db_source(<span class="stringliteral">&quot;test.db&quot;</span>);</div>
<div class="line">std::any storage = std::vector&lt;std::tuple&lt;int, std::string, int&gt;&gt;{};</div>
<div class="line"> </div>
<div class="line">std::unordered_map&lt;int, datamanagement::source::BindingVariant&gt; bindings;</div>
<div class="line">bindings[1] = 1;</div>
<div class="line">db_source.Select(</div>
<div class="line">    <span class="stringliteral">&quot;SELECT * FROM test WHERE id = ?;&quot;</span>,</div>
<div class="line">    [](std::any &amp;storage, <span class="keyword">const</span> SQLite::Statement &amp;stmt) {</div>
<div class="line">        std::vector&lt;std::tuple&lt;int, std::string, int&gt;&gt; *results =</div>
<div class="line">            std::any_cast&lt;std::vector&lt;std::tuple&lt;int, std::string, int&gt;&gt;&gt;(</div>
<div class="line">                &amp;storage);</div>
<div class="line">        results-&gt;emplace_back(stmt.getColumn(0).getInt(),</div>
<div class="line">                                stmt.getColumn(1).getText(),</div>
<div class="line">                                stmt.getColumn(2).getInt());</div>
<div class="line">    },</div>
<div class="line">    storage, bindings);</div>
<div class="line"> </div>
<div class="line">std::vector&lt;std::tuple&lt;int, std::string, int&gt;&gt; results =</div>
<div class="line">    std::any_cast&lt;std::vector&lt;std::tuple&lt;int, std::string, int&gt;&gt;&gt;(storage);</div>
<div class="line"> </div>
<div class="ttc" id="aclassdatamanagement_1_1source_1_1DBSource_html"><div class="ttname"><a href="classdatamanagement_1_1source_1_1DBSource.html">datamanagement::source::DBSource</a></div><div class="ttdef"><b>Definition</b> db_source.hpp:31</div></div>
</div><!-- fragment --><p>For Batch Execution of Inserts/Creations/Deletions:</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classdatamanagement_1_1source_1_1DBSource.html">datamanagement::source::DBSource</a> db_source(<span class="stringliteral">&quot;test.db&quot;</span>);</div>
<div class="line">std::string query = <span class="stringliteral">&quot;INSERT INTO test (name, age) VALUES (?, ?);&quot;</span>;</div>
<div class="line">std::vector&lt;std::unordered_map&lt;int, datamanagement::source::BindingVariant&gt;&gt;</div>
<div class="line">    batch_bindings;</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 10; ++i) {</div>
<div class="line">    std::unordered_map&lt;int, datamanagement::source::BindingVariant&gt;</div>
<div class="line">        bindings;</div>
<div class="line">    bindings[1] = i;</div>
<div class="line">    bindings[2] = <span class="stringliteral">&quot;Test&quot;</span> + std::to_string(i);</div>
<div class="line">    batch_bindings.emplace_back(bindings);</div>
<div class="line">}</div>
<div class="line">db_source.BatchExecute(query, batch_bindings);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md17"></a>
How to Contribute</h2>
<p>Currently, this work is supported and under active development by the Syndemics Lab team. Open contributions are welcome but accepted on a very limited basis as this is a functional underpinning for our team's private models. If there are issues or requests please fill out a new issue and we'll respond as soon as possible. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
